# ポピュレーションワン チーム分け
Population One プライベートルーム用チーム分け（他のFPSゲームでも使えるかもしれません）   
スクワッドの合計キルレートが同じくらいになるようにチーム分けをします。  
各スクワッドの合計キルレートの差をどのくらいまで許容するかを設定できます。  
組み合わせ可能な最大人数は50人です。
common.js の「maxPlayer」の値で変更可能です。

## 組み合わせの仕組み
組み合わせ方法は総当りで検証しているわけではなく、ランダムなスクワッドを最大100,000回抽選し、その中に要件を満たす組み合わせがあればチーム分けを行います。なければ「要件を満たす組み合わせが見つかりませんでした」となります。  
組み合わせが見つからない場合は再度抽選を行うか、[キルレートによる組み合わせ調整範囲](#キルレートによる組み合わせ調整範囲)を大きくするか、[メンバー固定](#チェックボックスfix-or-freeメンバー固定用)の設定をしている場合は固定を解除してください。

## DEMO
[https://necobusvr.github.io/grouping/](https://necobusvr.github.io/grouping/)

## CSV Import
CSVファイルでプレイヤーをインポートできます。
1行目の文字（player_name と kill_rate と teamMate_check）は変更しないでください。  
2行目以降のA列にプレイヤー名、B列にキルレート（半角数字）、C列に同じスクワッドにしたい人に checked と入力してください。  
CSVファイルの用意ができたら、**CSVインポート**からCSVファイルを選択するとプレイヤー情報が反映されます。  
文字コードが異なると日本語が文字化けします。CSVファイルの文字コードが「UTF-8」「Shift-JIS」のどちらになっているか選択してください。CSVファイルをGoogle スプレッドシートで作ったのなら「UTF-8」、Excelで作ったのなら「Shift-JIS」です。  

CSVファイル ダウンロード  
[https://necobusvr.github.io/grouping/csv/example.csv](https://necobusvr.github.io/grouping/csv/example.csv)

## 設定項目

### スクワッドのプレイヤー数
スクワッドのプレイヤー最大人数を入力

### キルレートによる組み合わせ調整範囲
各スクワッドの合計キルレートの差が設定した数値以内になるようにチーム分けされます。

### 3人スクワッドで余りが1人になった場合の処理
**3人スクワッドの場合のみ利用。**  
参加メンバーの総数を3で割ったときに余りが1になる場合スクワッドのプレイヤー数を調整します。  
数値（デフォルトは1）を入力すると2人スクワッドまたは4人スクワッドのキルレートの合計値にこの数値が掛けられ、この数値のキルレートで組み合わせ抽選が行われます。  
3人スクワッドより人数が少なかったり多かったりするスクワッドの場合キルレートの合計値がスクワッドの戦力と考えるのは難しいのでこの値で調整してください。数値を大きくすると弱いスクワッドになり小さくすると強いスクワッドになります。

例：11人で、[キルレートによる組み合わせ調整範囲](#キルレートによる組み合わせ調整範囲)が0.5  
3人×3人×3人×4人 のスクワッドでキルレート合計値が左から「4.3、4.0、3.8、3.5」の場合キルレートの差が最大で0.5なので通常なら組み合わせは成立しませんが、3人スクワッドで余りが1人になった場合の処理の数値を1.1とすると組み合わせで使用されるキルレートは「4.3、4.0、3.8、（3.5×1.1）」となり「4.3、4.0、3.8、3.85」になるので組み合わせが成立します。  
このような調整ができるので必要に応じて使ってください。

#### 「2人チームを作る」を選択した場合
2人のスクワッドが2チーム作られます。

#### 「4人チームを作る」を選択した場合
4人のスクワッドが1チーム作られます。

## 入力項目

### player name ##
プレイヤー名を入力

### kill rate
キルレートを入力

### チェックボックス（Fix or Free）メンバー固定用
1チームだけメンバーを固定してチーム分けをする事ができます。  
固定したいメンバーの**Free**にチェックを入れると**Fix**に変わります。  
Fixにできる人数は2人から1スクワッドのプレイヤー数までです。

## テキストデータのコピー
抽選結果の下の「コピー用テキストデータ」の【Copy する】をタップすると組み合わせ結果のテキストデータをクリップボードにコピーできます。

## Author
NECOBUS

## ライセンス
MIT License
